@(lesson: Lesson, section: Integer)(content: Html)

@scripts = {
	<link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/font-awesome.min.css")">
	<link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/froala_editor.min.css")">
	<link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/froala_style.min.css")">
	
	<script src="@routes.Assets.versioned("javascripts/froala/froala_editor.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/font_size.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/colors.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/font_family.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/lists.min.js")" type="text/javascript"></script>
	<script>
		$(function(){
			$('#publish-lesson-btn').on('click', function(){
				var spinner = $('<i class="glyphicon glyphicon-refresh glyphicon-spinner spinner"></i>');
				
				$('#publish-lesson-btn').after(spinner);
	        	$('#publish-lesson-btn').attr("disabled", true);
	        	$('#publish-lesson-btn').text("");
	        	
				$.ajax({
	                url: "@routes.LessonController.publishLesson()",
	                type: "POST",
	                data: {
	                	lessonId: @lesson.id
	                },
	                success: function(response, status) {
	                	var data = $.parseJSON(JSON.stringify(response));
	                	
	                	if(data.code == 0){
	                		showAlertToast(data.message, "alert-success");
	                	}else if(data.code == 5000){
	                		showAlertToast(data.message, "alert-warning");
	                	}else{
	                		showAlertToast(data.message, "alert-danger");
	                	}
	                	spinner.remove();
	                	$('#publish-lesson-btn').attr("disabled", false);
	                	$('#publish-lesson-btn').text("发布课程");
	                },
	                error: function(request, status, err){
	                	showAlertToast(err, "alert-danger");
	                	spinner.remove();
	                	$('#publish-lesson-btn').attr("disabled", false);
	                	$('#publish-lesson-btn').text("发布课程");
	                }
	            });
				
			});
		});
	</script>
}

@main(scripts){
	<div id="dash-content" class="dash-bg">
	
		<div id="lesson-header" class="dash-block">
			@if(lesson.teacher.avatars != null && lesson.teacher.avatars.size() > 0){
				<a style="background-image:url('@routes.ProfileController.showAvatarThumbnail(lesson.teacher.avatars.get(0).thumbnailUUID)');" class="link-img"></a>
			}else{
				<a style="background-image:url('@routes.ProfileController.showAvatarThumbnail()');" class="link-img"></a>
			}
			<div class="lesson-brief">
				<p class="bold-style">@lesson.title</p>
				<p>
					<span class="lbl-key">教师：</span>
					<span class="lbl-value">@lesson.teacher.username</span>
				</p>
			</div>
			<div class="btn-wrap">
				@if(section == 0 || section == 5){
					<div>
						<a id="save-lesson-btn" class="btn btn-info">保存修改</a>
					</div>				
				}
				<div>
					<a id="publish-lesson-btn" class="btn btn-success">发布课程</a>
				</div>
			</div>
		</div>
		
		<div id="sidebar" class="dash-block">
		   	<p>基本信息</p>
		    <ul class="sidebar-menu" id="nav-accordion">
		        <li class="sub-menu dcjq-parent-li">
		            <a @if(section == 0){class="active"} href="@routes.LessonController.editLesson(lesson.id)">
		                <i class="fa fa-dashboard"></i>
		                <span>基本信息</span>
		            </a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a @if(section == 1){class="active"} href="@routes.LessonController.editLessonImages(lesson.id)">
		                <i class="fa fa-picture-o"></i>
		                <span>课程图片</span>
		            	<span class="dcjq-icon"></span>
		            </a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a @if(section == 2){class="active"} href="@routes.LessonController.lessonSession(lesson.id, 0)">
		                <i class="fa fa-clock-o"></i>
		                <span>课时管理</span>
		            	<span class="dcjq-icon"></span>
		            </a>
		        </li>
		        <li class="sub-menu dcjq-parent-li">
		            <a href="javascript:;" class="dcjq-parent">
		                <i class="fa fa-video-camera"></i>
		                <span>录播管理</span>
		            <span class="dcjq-icon"></span></a>
		        </li>
		        <li class="sub-menu dcjq-parent-li">
		            <a @if(section == 4){class="active"} href="@routes.FileController.fileManagement(lesson.id)">
		                <i class="fa fa-file-o"></i>
		                <span>文件管理</span>
		            <span class="dcjq-icon"></span></a>
		        </li>
		    </ul>
		    
		    <p class="main-title">课程设置</p>
		    <ul class="sidebar-menu" id="nav-accordion">
		        <li class="sub-menu dcjq-parent-li">
		            <a @if(section == 5){class="active"} href="@routes.LessonController.lessonPrice(lesson.id)">
		                <i class="fa fa-money"></i>
		                <span>价格设置</span>
		            </a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a href="javascript:;" class="dcjq-parent">
		                <i class="fa fa-users"></i>
		                <span>老师设置</span>
		            	<span class="dcjq-icon"></span></a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a href="javascript:;" class="dcjq-parent">
		                <i class="fa fa-graduation-cap"></i>
		                <span>学员管理</span>
		            <span class="dcjq-icon"></span></a>
		        </li>
		    </ul>
		    
		    <p class="main-title">题库管理</p>
		    <ul class="sidebar-menu" id="nav-accordion">
		        <li class="sub-menu dcjq-parent-li">
		            <a href="index.html">
		                <i class="fa fa-dashboard"></i>
		                <span>题目管理</span>
		            </a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a href="javascript:;" class="dcjq-parent">
		                <i class="fa fa-desktop"></i>
		                <span>试卷管理</span>
		            	<span class="dcjq-icon"></span></a>
		        </li>
		
		        <li class="sub-menu dcjq-parent-li">
		            <a href="javascript:;" class="dcjq-parent">
		                <i class="fa fa-cogs"></i>
		                <span>试卷批阅</span>
		            <span class="dcjq-icon"></span></a>
		        </li>
		    </ul>
		</div>
	
		<div id="dash-detail-wrap" class="lesson-dash">
			<div id="dash-detail" class="dash-block">
				@content
			</div>
		</div>
	</div>
}

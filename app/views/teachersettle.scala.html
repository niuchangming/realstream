@import tags._

@(account: Account)

@scripts = {
	<link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/font-awesome.min.css")">
    <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets//bootstrap-datetimepicker.min.css")">
    <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/froala_editor.min.css")">
	<link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/froala/froala_style.min.css")">
	
    <script src="@routes.Assets.versioned("javascripts/moment.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/froala_editor.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/font_size.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/colors.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/font_family.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.versioned("javascripts/froala/lists.min.js")" type="text/javascript"></script>
}
 
@main(scripts) {
	@topbar(account)
	<div id="teacher-settle-content" class="dash-bg">
		<section>
			<div class="note-block">
				<p class="prompt">老师入驻</p>
				<p class="value">
					<span>链接亿万用户，传递思想，实现价值</span>
					<span class="new-line">目前对个人老师开放全部课程类型的课程发布。<a>了解更多</a></span>
				</p>
			</div>
			
			<div class="mod-steps">
				<ul class="steps-nav">
					<li><i class="i-right fa fa-check"></i><span class="steps-num">1</span>签订入驻协议</li>
					<li class="active"><i class="i-right"></i><span class="steps-num">2</span>提交资料</li>
	                <li><i class="i-right"></i><span class="steps-num">3</span>入驻审核</li>
				</ul>
			</div>
			
			<div class="wrap-step wrap-step-2" style="display: block;">
				@helper.form(action = routes.ProfileController.submitteacherInfo(), 'id-> "teacher-info-form", 'method -> "POST", 'enctype -> "multipart/form-data") {
					<div class="mod-form__block">
					   <h6 class="mod-form__block-name">身份证明</h6>
					   <div class="mod-form__block-content">
					      <!-- 真实姓名 --> 
					      <div class="form-group">
					         <div class="form-label">
					            <label for="real-name"><b>*</b>真实姓名:</label>
					         </div>
					         <div class="form-input">
					            <input id="real-name" type="text" class="form-control" name="realName" placeholder="真实姓名，需与身份证一致">
					         </div>
					      </div>
					      <!-- 身份证 --> 
					      <div class="form-group">
					         <div id="ic-wrap" class="form-label">	
					            <label><b>*</b>身份证:</label>
					         </div>
					         <div class="uploader">
					            <a id="ic-link" class="link-img hidden"></a>
					            <div class="upload-wrap">
					               <i class="fa fa-picture-o" aria-hidden="true"></i>
					               <div class="upload-text">
					                  <p>Drop your IC here</p>
					                  <p class="small-p">or</p>
					               </div>
					               <a class="browse-btn">Browse Files</a>
					               <input id="ic-uploader" class="file-input" type="file" name="icImage"/>
					            </div>
					         </div>
					         <div class="upload-tips">
					            <p> 请上传手持身份证的半身照<br>文件小于2M<br>支持JPG/PNG/BMP等格式图片 </p>
					         </div>
					      </div>
					      <!-- 资格证书 --> 
					      <div class="form-group">
					         <div id="cert-wrap" class="form-label">	
					            <label><b>*</b>资格证书:</label>
					         </div>
					         <div class="uploader">
					            <a id="cert-link" class="link-img hidden"></a>
					            <div class="upload-wrap">
					               <i class="fa fa-picture-o" aria-hidden="true"></i>
					               <div class="upload-text">
					                  <p>Drop Certificate here</p>
					                  <p class="small-p">or</p>
					               </div>
					               <a class="browse-btn">Browse Files</a>
					               <input id="cert-uploader" class="file-input" type="file" name="certImage"/>
					            </div>
					         </div>
					         <div class="upload-tips">
					            <p>请提交有效的教师资格凭证或相关专业文凭照片<br>需确保头像和文字清晰，文件小于2M<br>支持JPG/PNG/BMP等格式图片 </p>
					         </div>
					      </div>
					      <!-- 个人简介 -->
					      <div class="form-group">
					         <div class="form-label">
					            <label for="personal-brief"><b>*</b>个人简介:</label>
					         </div>
					         <div class="form-input long-txt">
					            <textarea id="personal-brief" class="form-control" name="brief" rows="5" placeholder="如：我是一名会调酒的音乐老师，擅长风趣幽默，爱好跑马拉松。显示在老师主页上，建议体现更多个人才艺、授课的人格魅力。"></textarea>
					            <div class="upload-tips">
					               <p>将显示在老师主页上，请尽可能体现出个人的教学方向和经验优势 <span class="orange">200个字以内</span> </p>
					            </div>
					         </div>
					      </div>
					      
					      <div class="form-group">
					         <div class="form-label">
					            <label for="best-institution"><b>*</b>曾任教的机构:</label>
					         </div>
					         <div class="form-input long-txt">
					            <div class="form-input">
						            <input id="best-institution" type="text" class="form-control" name="institution" placeholder="教育机构名称">
						         </div>
					            <div class="upload-tips institution-tip">
					               <p>将显示在老师主页上，请填写您任教的最好的教育机构</p>
					            </div>
					         </div>
					      </div>
					   </div>
					</div>
					<div class="form-group">
					   <div class="form-label">
					      <label for="start-datepicker"><b>*</b>教学经历:</label>
					   </div>
					   <div class="experience-block">
					      <div class="experience-row">
					         <div class="form-input">
					            <input type="text" class="form-control from-datepikcer" name="fromDate[]" data-date-format="YYYY-MM-DD" placeholder="请选择开始时间">
					         </div>
					         <span class="form-join">至</span>
					         <div class="form-input">
					            <input type="text" class="form-control to-datepikcer" name="toDate[]" data-date-format="YYYY-MM-DD" placeholder="请选择结束时间">
					         </div>
					         <div class="form-input experience-input">
					            <input type="text" class="form-control" name="workExperience[]" placeholder="请填写教学工作经历">
					            <a href="javascript:;" class="del-experience-btn hidden">删除</a>
					         </div>
					      </div>
					      <a class="add-more-btn">
					      +继续添加工作经历
					      </a>
					   </div>
					</div>
					<div class="form-group txt-center form-submit">
					   <input class="btn btn-success" type="submit" value="提交资料"/>
					</div>
				}
			</div>
		</section>
	</div>
	<script src="@routes.Assets.versioned("javascripts/bootstrap-datetimepicker.js")" type="text/javascript"></script>
	<script type="text/javascript">
		$(function(){
			$(document).on('focus',".from-datepikcer", function(){
			    $(this).datetimepicker();
			});
			
			$(document).on('focus',".to-datepikcer", function(){
			    $(this).datetimepicker();
			});
			
			$('#personal-brief').editable({inlineMode: true});
			
			$(".uploader").on("change", function(e){
				var file = e.originalEvent.srcElement.files[0];
				if(file){
		        	var reader = new FileReader();
		        	var inputEle = $(this);
			        reader.onloadend = function() {
			        	var uploaderEle = inputEle.closest('.uploader');
	                	var browserEle = uploaderEle.find('.browse-btn');
	                	var icLinkEle = uploaderEle.find('.link-img');
	                	
	                	uploaderEle.addClass('noborder');
	                	icLinkEle.removeClass('hidden');
	                	browserEle.hide();
	                	icLinkEle.css('background-image', 'url(\'' + reader.result + '\')');
			        }
			        reader.readAsDataURL(file);
		        }
			});
			
			$(document).on('click', "a.add-more-btn", function(){
				var experRow = '<div class="experience-row">';
				experRow += '<div class="form-input">';
				experRow += '<input type="text" class="form-control from-datepikcer" name="fromDate[]" data-date-format="YYYY-MM-DD" placeholder="请选择开始时间">';
				experRow += '</div>';
				experRow += '<span class="form-join">至</span>';
				experRow += '<div class="form-input">';
				experRow += '<input type="text" class="form-control to-datepikcer" name="toDate[]" data-date-format="YYYY-MM-DD" placeholder="请选择结束时间">';
				experRow += '</div>';
				experRow += '<div class="form-input experience-input">';
				experRow += '<input type="text" class="form-control" name="workExperience[]" placeholder="请填写教学工作经历">';
				experRow += '<a href="javascript:;" class="del-experience-btn">删除</a>';
				experRow += '</div></div>';
				
				$(this).before(experRow);
			});
			
			$(document).on('click', "a.del-experience-btn", function(){
				$(this).closest('.experience-row').remove();
			});
			
			$("#teacher-info-form").validate({
				ignore: [],
		        rules: {
		        	realName:{
		            	minlength: 6,
		                maxlength: 50,
		            	required:true
		            },
		            brief:{
		            	minlength: 10,
		            	required:true
		            },
		            institution:{
		            	required:true
		            },
		            'workExperience[]': {
		            	required: true
		            },
		            'fromDate[]':{
		            	largerThanToday: true,
		            	required: true
		            },
		            'toDate[]':{
		            	required: true
		            },
		            icImage:{
		            	required: true
		            },
		            certImage:{
		            	required: true
		            }
		        },
		        highlight: function (element) {
		            $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
		        },
		        unhighlight: function (element) {
		            $(element).closest('.form-group').removeClass('has-error').addClass('has-success');
		        },
		        submitHandler: function(form) {
		        	form.submit();
		        }
		    });
			
			$.validator.addMethod("largerThanToday", function(value, element) {
	            return new Date() > Date.parse(value) || value == "";
	        }, "Date must be after today");
			
	   	});
	
	</script>
}
